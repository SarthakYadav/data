Search.setIndex({"docnames": ["index", "stateful_dataloader_tutorial", "torchdata.nodes", "torchdata.stateful_dataloader"], "filenames": ["index.rst", "stateful_dataloader_tutorial.rst", "torchdata.nodes.rst", "torchdata.stateful_dataloader.rst"], "titles": ["TorchData", "Stateful DataLoader Tutorial", "torchdata.nodes", "Stateful DataLoader"], "terms": {"june": [0, 1, 2, 3], "2024": [0, 1, 2, 3], "statu": [0, 1, 2, 3], "updat": [0, 1, 2, 3], "remov": [0, 1, 2, 3], "datapip": [0, 1, 2, 3], "dataload": [0, 2], "v2": [0, 1, 2, 3], "we": [0, 1, 2, 3], "ar": [0, 1, 2, 3], "re": [0, 1, 2, 3], "focus": [0, 1, 2, 3], "repo": [0, 1, 2, 3], "an": [0, 1, 2, 3], "iter": [0, 2, 3], "enhanc": [0, 1, 2, 3], "torch": [0, 1, 3], "util": [0, 1, 3], "data": [0, 1, 3], "do": [0, 1, 3], "plan": [0, 1, 2, 3], "continu": [0, 1, 2, 3], "develop": [0, 1, 2, 3], "maintain": [0, 1, 2, 3], "dataloaderv2": [0, 1, 2, 3], "solut": [0, 1, 2, 3], "thei": [0, 1, 2, 3], "from": [0, 1, 2, 3], "ll": [0, 1, 2, 3], "also": [0, 1, 2, 3], "revisit": [0, 1, 2, 3], "In": [0, 1, 2, 3], "releas": [0, 1, 2, 3], "0": [0, 1, 2, 3], "8": [0, 1, 2, 3], "juli": [0, 1, 2, 3], "mark": [0, 1, 2, 3], "deprec": [0, 1, 2, 3], "10": [0, 1, 2, 3], "late": [0, 1, 2, 3], "delet": [0, 1, 2, 3], "exist": [0, 1, 2, 3], "user": [0, 1, 2, 3], "advis": [0, 1, 2, 3], "pin": [0, 1, 2, 3], "9": [0, 1, 2, 3], "older": [0, 1, 2, 3], "version": [0, 1, 2, 3], "until": [0, 1, 2, 3], "abl": [0, 1, 2, 3], "migrat": [0, 1, 2, 3], "awai": [0, 1, 2, 3], "subsequ": [0, 1, 2, 3], "includ": [0, 1, 2, 3], "pleas": [0, 1, 2, 3], "reach": [0, 1, 2, 3], "out": [0, 1, 2, 3], "you": [0, 1, 2, 3], "suggest": [0, 1, 2, 3], "comment": [0, 1, 2, 3], "us": [0, 1, 2, 3], "thi": [0, 1, 2, 3], "issu": [0, 1, 2, 3], "feedback": [0, 1, 2, 3], "part": 0, "project": 0, "open": 0, "sourc": 0, "machin": 0, "learn": 0, "framework": [0, 2], "beta": 0, "common": [0, 2], "modular": 0, "load": [0, 2, 3], "primit": [0, 2], "easili": 0, "construct": 0, "flexibl": [0, 2], "perform": [0, 2], "pipelin": [0, 2], "And": 0, "few": [0, 2], "featur": 0, "still": [0, 2, 3], "prototyp": 0, "stage": 0, "describ": 0, "document": 0, "classifi": 0, "stabl": 0, "These": 0, "long": 0, "term": 0, "should": [0, 2, 3], "gener": [0, 1, 3], "major": 0, "limit": [0, 1, 2], "gap": 0, "expect": [0, 2], "backward": 0, "compat": 0, "although": [0, 2], "break": [0, 1, 2], "chang": 0, "can": [0, 1, 2, 3], "happen": 0, "notic": 0, "given": 0, "one": [0, 2, 3], "ahead": 0, "time": [0, 2, 3], "tag": 0, "becaus": [0, 2, 3], "mai": [0, 2], "base": [0, 3], "need": [0, 2], "improv": 0, "coverag": 0, "across": [0, 1, 3], "oper": [0, 2, 3], "yet": 0, "complet": [0, 3], "For": [0, 1, 2], "commit": 0, "see": [0, 2, 3], "through": [0, 2], "classif": 0, "howev": [0, 2, 3], "typic": 0, "avail": 0, "binari": 0, "distribut": [0, 1, 2, 3], "like": [0, 2, 3], "pypi": 0, "conda": 0, "except": 0, "sometim": 0, "behind": 0, "run": [0, 1], "flag": 0, "earli": 0, "test": [0, 1], "state": [0, 2], "node": 0, "what": 0, "get": 0, "start": [0, 3], "s": [0, 3], "point": 0, "design": 0, "choic": 0, "save": 0, "custom": [0, 3], "map": [0, 3], "style": [0, 3], "dataset": [0, 3], "torchtun": 0, "torchaudio": 0, "torchvis": 0, "torchelast": 0, "torchserv": 0, "xla": 0, "devic": [0, 3], "index": [0, 3], "torchdata": [1, 3], "refer": [1, 2, 3], "pytorch": [1, 2, 3], "add": [1, 2], "load_state_dict": [1, 2, 3], "state_dict": [1, 2, 3], "method": [1, 2, 3], "fetch": 1, "set": [1, 2, 3], "done": [1, 2], "follow": [1, 2], "stateful_dataload": [1, 3], "import": [1, 2], "statefuldataload": [1, 3], "num_work": [1, 2, 3], "2": [1, 2, 3], "i": [1, 2, 3], "batch": [1, 2, 3], "enumer": 1, "train": [1, 2, 3], "resum": 1, "previou": [1, 3], "checkpoint": [1, 2, 3], "effici": 1, "defin": [1, 2, 3], "your": [1, 2, 3], "sampler": [1, 3], "If": [1, 2, 3], "ha": [1, 2, 3], "worker": [1, 2, 3], "specif": 1, "eg": 1, "rng": [1, 3], "transform": 1, "type": [1, 2, 3], "default": [1, 3], "randomsampl": [1, 2, 3], "batchsampl": 1, "patch": 1, "when": [1, 2, 3], "so": [1, 2], "here": 1, "unnecessari": 1, "class": [1, 2, 3], "mysampl": 1, "int": [1, 2, 3], "def": [1, 2], "__init__": 1, "self": [1, 2], "high": 1, "seed": [1, 3], "g": [1, 3], "manual_se": 1, "__iter__": 1, "while": 1, "val": 1, "randint": 1, "size": [1, 3], "1": [1, 2, 3], "yield": [1, 3], "dict": [1, 2], "str": [1, 3], "ani": [1, 2, 3], "set_stat": 1, "return": [1, 2, 3], "get_stat": [1, 2], "option": [1, 3], "random": [1, 3], "noisyrang": 1, "mean": [1, 2, 3], "float": [1, 3], "std": 1, "tensor": [1, 3], "__len__": [1, 2, 3], "__getitem__": [1, 2], "idx": 1, "rais": 1, "indexerror": 1, "x": [1, 2], "normal": 1, "nois": 1, "item": 1, "set_rng_stat": 1, "get_rng_stat": 1, "both": [1, 2], "singl": [1, 2], "multiprocess": [1, 3], "print": [1, 2], "f": 1, "dl": 1, "5": [1, 2], "batch_siz": [1, 3], "drop_last": [1, 3], "fals": [1, 3], "append": 1, "sd": [1, 2], "batches2": 1, "list": [1, 2, 3], "3": [1, 2], "output": 1, "4526": 1, "7948": 1, "dtype": 1, "float64": 1, "6": 1, "5494": 1, "0470": 1, "7412": 1, "2438": 1, "4": [1, 2], "4807": 1, "0036": 1, "track": 1, "order": [1, 2], "requir": 1, "each": [1, 2, 3], "level": 1, "instanc": [1, 2, 3], "captur": 1, "which": [1, 2, 3], "handl": [1, 2, 3], "aggreg": [1, 3], "back": 1, "call": [1, 2, 3], "have": [1, 2, 3], "same": 1, "those": 1, "provid": 1, "myiterabledataset": 1, "iterabledataset": [1, 3], "worker_info": 1, "get_worker_info": [1, 2], "none": [1, 2, 3], "worker_id": 1, "id": [1, 3], "els": 1, "arr": 1, "randperm": 1, "rang": [1, 2], "len": [1, 2, 3], "12": 1, "11": 1, "librari": 2, "compos": 2, "let": 2, "chain": 2, "togeth": 2, "pre": 2, "proc": 2, "It": 2, "stream": 2, "program": 2, "model": 2, "configur": [2, 3], "desir": 2, "more": [2, 3], "standard": 2, "offer": [2, 3], "introduc": 2, "thread": 2, "parallel": 2, "process": [2, 3], "onli": [2, 3], "support": 2, "approach": 2, "first": 2, "mid": [2, 3], "epoch": [2, 3], "interfac": 2, "strive": 2, "mani": [2, 3], "possibl": 2, "extens": 2, "new": [2, 3], "subclass": 2, "itself": 2, "next": [2, 3], "reset": 2, "initial_st": 2, "notabl": 2, "__next__": 2, "nor": 2, "instal": 2, "pip": 2, "wrap": 2, "convert": 2, "iterablewrapp": 2, "parallelmapp": 2, "loader": [2, 3], "map_fn": 2, "lambda": [2, 3], "result": [2, 3], "16": 2, "25": 2, "36": 2, "49": 2, "64": 2, "81": 2, "samplerwrapp": 2, "squareddataset": 2, "fine": 2, "grain": 2, "control": 2, "own": [2, 3], "simpli": 2, "appli": 2, "function": [2, 3], "indic": [2, 3], "reus": 2, "just": 2, "work": 2, "case": [2, 3], "definit": 2, "bunch": 2, "rough": 2, "spot": 2, "duplic": [2, 3], "memori": [2, 3], "store": 2, "python": 2, "copi": [2, 3], "read": 2, "ipc": 2, "slow": 2, "over": 2, "queue": 2, "startup": 2, "forc": 2, "instead": [2, 3], "main": [2, 3], "reduc": [2, 3], "overhead": [2, 3], "increas": [2, 3], "peak": 2, "With": 2, "gil": 2, "free": 2, "bound": 2, "enabl": [2, 3], "choos": 2, "best": [2, 3], "particular": 2, "up": 2, "primarili": 2, "mapper": 2, "give": 2, "how": [2, 3], "great": 2, "true": [2, 3], "go": 2, "veri": 2, "onc": [2, 3], "grow": 2, "beyond": 2, "unless": 2, "jump": 2, "some": 2, "hoop": 2, "special": 2, "where": 2, "combin": 2, "abov": 2, "produc": 2, "The": 2, "per": [2, 3], "concept": 2, "down": [2, 3], "try": 2, "multipl": [2, 3], "abstract": 2, "consid": 2, "scenario": 2, "dsa": 2, "dsb": 2, "20": 2, "now": 2, "want": 2, "round": [2, 3], "robin": 2, "sampl": [2, 3], "uniformli": 2, "between": 2, "two": [2, 3], "feed": 2, "our": 2, "trainer": 2, "strategi": [2, 3], "mayb": 2, "emit": 2, "tupl": 2, "swap": 2, "distributedsampl": 2, "set_epoch": 2, "help": 2, "address": 2, "deal": 2, "therebi": 2, "smaller": [2, 3], "complex": 2, "fairli": 2, "reason": 2, "But": 2, "about": 2, "figur": 2, "http": 2, "github": 2, "com": 2, "pull": 2, "1362": 2, "thought": 2, "One": 2, "difficult": 2, "made": 2, "wa": 2, "disallow": 2, "drop": [2, 3], "move": 2, "foundat": 2, "around": 2, "manag": 2, "explicit": 2, "implicitli": 2, "stack": 2, "found": 2, "write": 2, "convolut": 2, "code": [2, 3], "basic": 2, "end": 2, "feel": 2, "natur": 2, "come": 2, "repres": [2, 3], "most": 2, "would": 2, "request": [2, 3], "twice": 2, "befor": [2, 3], "begin": 2, "live": 2, "problem": 2, "doe": 2, "rare": 2, "make": [2, 3], "assumpt": 2, "dev": 2, "opinion": 2, "wors": 2, "than": [2, 3], "all": [2, 3], "initi": 2, "pass": 2, "don": 2, "throw": 2, "stopiter": 2, "right": 2, "To": 2, "keep": 2, "take": 2, "replac": 3, "resp": 3, "By": 3, "number": 3, "naiv": 3, "fast": 3, "forward": 3, "them": 3, "dure": 3, "its": 3, "under": 3, "hood": 3, "rank": 3, "_t_co": 3, "shuffl": 3, "bool": 3, "union": 3, "batch_sampl": 3, "collate_fn": 3, "callabl": 3, "_t": 3, "pin_memori": 3, "timeout": 3, "worker_init_fn": 3, "multiprocessing_context": 3, "prefetch_factor": 3, "persistent_work": 3, "pin_memory_devic": 3, "snapshot_every_n_step": 3, "implement": 3, "argument": 3, "ident": 3, "kwarg": 3, "paramet": 3, "reshuffl": 3, "everi": 3, "draw": 3, "specifi": 3, "must": 3, "mutual": 3, "exclus": 3, "subprocess": 3, "merg": 3, "form": 3, "mini": 3, "cuda": 3, "element": 3, "exampl": 3, "below": 3, "last": 3, "incomplet": 3, "divis": 3, "numer": 3, "posit": 3, "valu": 3, "collect": 3, "alwai": 3, "non": 3, "neg": 3, "input": 3, "after": 3, "context": 3, "basecontext": 3, "system": 3, "base_se": 3, "keyword": 3, "arg": 3, "advanc": 3, "total": 3, "prefetch": 3, "depend": 3, "otherwis": 3, "shut": 3, "been": 3, "consum": 3, "allow": 3, "aliv": 3, "often": 3, "transfer": 3, "e": 3, "step": 3, "larg": 3, "ideal": 3, "frequenc": 3, "spawn": 3, "cannot": 3, "unpickl": 3, "object": 3, "practic": 3, "detail": 3, "relat": 3, "heurist": 3, "length": 3, "estim": 3, "proper": 3, "regardless": 3, "multi": 3, "guess": 3, "trust": 3, "correctli": 3, "avoid": 3, "shard": 3, "inaccur": 3, "broken": 3, "ones": 3, "worth": 3, "unfortun": 3, "detect": 3, "interact": 3, "reproduc": 3, "note": 3, "question": 3}, "objects": {"torchdata": [[3, 0, 0, "-", "stateful_dataloader"]], "torchdata.stateful_dataloader": [[3, 1, 1, "", "StatefulDataLoader"]]}, "objtypes": {"0": "py:module", "1": "py:class"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"]}, "titleterms": {"torchdata": [0, 2], "api": 0, "refer": 0, "tutori": [0, 1], "exampl": [0, 2], "pytorch": 0, "librari": 0, "indic": 0, "state": [1, 3], "dataload": [1, 3], "save": 1, "load": 1, "custom": 1, "map": [1, 2], "style": [1, 2], "dataset": [1, 2], "iter": 1, "node": 2, "what": 2, "get": 2, "start": 2, "gener": 2, "sampler": 2, "s": 2, "point": 2, "multiprocess": 2, "suck": 2, "random": 2, "access": 2, "doesn": 2, "t": 2, "scale": 2, "multi": 2, "do": 2, "fit": 2, "well": 2, "current": 2, "implement": 2, "torch": 2, "util": 2, "data": 2, "iterabledataset": 2, "requir": 2, "addit": 2, "shard": 2, "design": 2, "choic": 2, "No": 2, "basenod": 2}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})