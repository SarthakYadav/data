Search.setIndex({"docnames": ["index", "stateful_dataloader_tutorial", "torchdata.stateful_dataloader"], "filenames": ["index.rst", "stateful_dataloader_tutorial.rst", "torchdata.stateful_dataloader.rst"], "titles": ["TorchData", "Stateful DataLoader Tutorial", "Stateful DataLoader"], "terms": {"june": [0, 1, 2], "2024": [0, 1, 2], "statu": [0, 1, 2], "updat": [0, 1, 2], "remov": [0, 1, 2], "datapip": [0, 1, 2], "dataload": 0, "v2": [0, 1, 2], "we": [0, 1, 2], "ar": [0, 1, 2], "re": [0, 1, 2], "focus": [0, 1, 2], "repo": [0, 1, 2], "an": [0, 1, 2], "iter": [0, 2], "enhanc": [0, 1, 2], "torch": [0, 1, 2], "util": [0, 1, 2], "data": [0, 1, 2], "do": [0, 1, 2], "plan": [0, 1, 2], "continu": [0, 1, 2], "develop": [0, 1, 2], "maintain": [0, 1, 2], "dataloaderv2": [0, 1, 2], "solut": [0, 1, 2], "thei": [0, 1, 2], "from": [0, 1, 2], "ll": [0, 1, 2], "also": [0, 1, 2], "revisit": [0, 1, 2], "In": [0, 1, 2], "releas": [0, 1, 2], "0": [0, 1, 2], "8": [0, 1, 2], "juli": [0, 1, 2], "mark": [0, 1, 2], "deprec": [0, 1, 2], "10": [0, 1, 2], "late": [0, 1, 2], "delet": [0, 1, 2], "exist": [0, 1, 2], "user": [0, 1, 2], "advis": [0, 1, 2], "pin": [0, 1, 2], "9": [0, 1, 2], "older": [0, 1, 2], "version": [0, 1, 2], "until": [0, 1, 2], "abl": [0, 1, 2], "migrat": [0, 1, 2], "awai": [0, 1, 2], "subsequ": [0, 1, 2], "includ": [0, 1, 2], "pleas": [0, 1, 2], "reach": [0, 1, 2], "out": [0, 1, 2], "you": [0, 1, 2], "suggest": [0, 1, 2], "comment": [0, 1, 2], "us": [0, 1, 2], "thi": [0, 1, 2], "issu": [0, 1, 2], "feedback": [0, 1, 2], "part": 0, "project": 0, "open": 0, "sourc": 0, "machin": 0, "learn": 0, "framework": 0, "beta": 0, "common": 0, "modular": 0, "load": [0, 2], "primit": 0, "easili": 0, "construct": 0, "flexibl": 0, "perform": 0, "pipelin": 0, "And": 0, "few": 0, "featur": 0, "still": [0, 2], "prototyp": 0, "stage": 0, "describ": 0, "document": 0, "classifi": 0, "stabl": 0, "These": 0, "long": 0, "term": 0, "should": [0, 2], "gener": [0, 1, 2], "major": 0, "limit": [0, 1], "gap": 0, "expect": 0, "backward": 0, "compat": 0, "although": 0, "break": [0, 1], "chang": 0, "can": [0, 1, 2], "happen": 0, "notic": 0, "given": 0, "one": [0, 2], "ahead": 0, "time": [0, 2], "tag": 0, "becaus": [0, 2], "mai": 0, "base": [0, 2], "need": 0, "improv": 0, "coverag": 0, "across": [0, 1, 2], "oper": [0, 2], "yet": 0, "complet": [0, 2], "For": [0, 1], "commit": 0, "see": [0, 2], "through": 0, "classif": 0, "howev": [0, 2], "typic": 0, "avail": 0, "binari": 0, "distribut": [0, 1, 2], "like": [0, 2], "pypi": 0, "conda": 0, "except": 0, "sometim": 0, "behind": 0, "run": [0, 1], "flag": 0, "earli": 0, "test": [0, 1], "state": 0, "save": 0, "custom": [0, 2], "map": [0, 2], "style": [0, 2], "dataset": [0, 2], "torchtun": 0, "torchaudio": 0, "torchvis": 0, "torchelast": 0, "torchserv": 0, "xla": 0, "devic": [0, 2], "index": [0, 2], "torchdata": [1, 2], "refer": [1, 2], "pytorch": [1, 2], "add": 1, "load_state_dict": [1, 2], "state_dict": [1, 2], "method": [1, 2], "fetch": 1, "set": [1, 2], "done": 1, "follow": 1, "stateful_dataload": [1, 2], "import": 1, "statefuldataload": [1, 2], "num_work": [1, 2], "2": [1, 2], "i": [1, 2], "batch": [1, 2], "enumer": 1, "train": [1, 2], "resum": 1, "previou": [1, 2], "checkpoint": [1, 2], "effici": 1, "defin": [1, 2], "your": [1, 2], "sampler": [1, 2], "If": [1, 2], "ha": [1, 2], "worker": [1, 2], "specif": 1, "eg": 1, "rng": [1, 2], "transform": 1, "type": [1, 2], "default": [1, 2], "randomsampl": [1, 2], "batchsampl": 1, "patch": 1, "when": [1, 2], "so": 1, "here": 1, "unnecessari": 1, "class": [1, 2], "mysampl": 1, "int": [1, 2], "def": 1, "__init__": 1, "self": 1, "high": 1, "seed": [1, 2], "g": [1, 2], "manual_se": 1, "__iter__": 1, "while": 1, "val": 1, "randint": 1, "size": [1, 2], "1": [1, 2], "yield": [1, 2], "dict": 1, "str": [1, 2], "ani": [1, 2], "set_stat": 1, "return": [1, 2], "get_stat": 1, "option": [1, 2], "random": [1, 2], "noisyrang": 1, "mean": [1, 2], "float": [1, 2], "std": 1, "tensor": [1, 2], "__len__": [1, 2], "__getitem__": 1, "idx": 1, "rais": 1, "indexerror": 1, "x": 1, "normal": 1, "nois": 1, "item": 1, "set_rng_stat": 1, "get_rng_stat": 1, "both": 1, "singl": 1, "multiprocess": [1, 2], "print": 1, "f": 1, "dl": 1, "5": 1, "batch_siz": [1, 2], "drop_last": [1, 2], "fals": [1, 2], "append": 1, "sd": 1, "batches2": 1, "list": [1, 2], "3": 1, "output": 1, "4526": 1, "7948": 1, "dtype": 1, "float64": 1, "6": 1, "5494": 1, "0470": 1, "7412": 1, "2438": 1, "4": 1, "4807": 1, "0036": 1, "track": 1, "order": 1, "requir": 1, "each": [1, 2], "level": 1, "instanc": [1, 2], "captur": 1, "which": [1, 2], "handl": [1, 2], "aggreg": [1, 2], "back": 1, "call": [1, 2], "have": [1, 2], "same": 1, "those": 1, "provid": 1, "myiterabledataset": 1, "iterabledataset": [1, 2], "worker_info": 1, "get_worker_info": 1, "none": [1, 2], "worker_id": 1, "id": [1, 2], "els": 1, "arr": 1, "randperm": 1, "rang": 1, "len": [1, 2], "12": 1, "11": 1, "drop": 2, "replac": 2, "offer": 2, "mid": 2, "epoch": 2, "next": 2, "request": 2, "resp": 2, "By": 2, "number": 2, "naiv": 2, "fast": 2, "forward": 2, "them": 2, "dure": 2, "its": 2, "own": 2, "under": 2, "hood": 2, "rank": 2, "_t_co": 2, "shuffl": 2, "bool": 2, "union": 2, "batch_sampl": 2, "collate_fn": 2, "callabl": 2, "_t": 2, "pin_memori": 2, "timeout": 2, "worker_init_fn": 2, "multiprocessing_context": 2, "prefetch_factor": 2, "persistent_work": 2, "pin_memory_devic": 2, "snapshot_every_n_step": 2, "implement": 2, "enabl": 2, "all": 2, "argument": 2, "ident": 2, "new": 2, "kwarg": 2, "paramet": 2, "how": 2, "mani": 2, "sampl": 2, "per": 2, "true": 2, "reshuffl": 2, "everi": 2, "strategi": 2, "draw": 2, "specifi": 2, "must": 2, "indic": 2, "mutual": 2, "exclus": 2, "subprocess": 2, "main": 2, "process": 2, "merg": 2, "form": 2, "mini": 2, "s": 2, "loader": 2, "copi": 2, "cuda": 2, "memori": 2, "befor": 2, "element": 2, "exampl": 2, "below": 2, "last": 2, "incomplet": 2, "divis": 2, "smaller": 2, "numer": 2, "posit": 2, "valu": 2, "collect": 2, "alwai": 2, "non": 2, "neg": 2, "input": 2, "after": 2, "context": 2, "basecontext": 2, "system": 2, "base_se": 2, "keyword": 2, "onli": 2, "arg": 2, "advanc": 2, "total": 2, "prefetch": 2, "depend": 2, "otherwis": 2, "shut": 2, "down": 2, "been": 2, "consum": 2, "onc": 2, "allow": 2, "aliv": 2, "often": 2, "transfer": 2, "e": 2, "step": 2, "larg": 2, "increas": 2, "ideal": 2, "frequenc": 2, "reduc": 2, "overhead": 2, "spawn": 2, "start": 2, "cannot": 2, "unpickl": 2, "object": 2, "lambda": 2, "function": 2, "best": 2, "practic": 2, "more": 2, "detail": 2, "relat": 2, "heurist": 2, "length": 2, "instead": 2, "estim": 2, "proper": 2, "round": 2, "regardless": 2, "multi": 2, "configur": 2, "repres": 2, "guess": 2, "make": 2, "trust": 2, "code": 2, "correctli": 2, "avoid": 2, "duplic": 2, "shard": 2, "result": 2, "multipl": 2, "inaccur": 2, "broken": 2, "ones": 2, "than": 2, "worth": 2, "unfortun": 2, "detect": 2, "case": 2, "two": 2, "interact": 2, "reproduc": 2, "note": 2, "question": 2}, "objects": {"torchdata": [[2, 0, 0, "-", "stateful_dataloader"]], "torchdata.stateful_dataloader": [[2, 1, 1, "", "StatefulDataLoader"]]}, "objtypes": {"0": "py:module", "1": "py:class"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"]}, "titleterms": {"torchdata": 0, "api": 0, "refer": 0, "tutori": [0, 1], "exampl": 0, "pytorch": 0, "librari": 0, "indic": 0, "state": [1, 2], "dataload": [1, 2], "save": 1, "load": 1, "custom": 1, "map": 1, "style": 1, "dataset": 1, "iter": 1}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})